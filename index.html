<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Manufacturer Checklist & Financial Summary</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
    h1, h2 { text-align: center; color: #333; }
    #instructions {
      background: #fff8dc; border: 1px solid #ccc; padding: 15px; margin-bottom: 20px;
    }
    table { width: 100%; border-collapse: collapse; background: #fff; margin-bottom: 30px; }
    th, td {
      border: 1px solid #ccc; padding: 10px; text-align: left; vertical-align: top;
    }
    th { background-color: #eee; }
    tr:nth-child(even) { background-color: #f2f2f2; }
    .category { background-color: #dfefff; font-weight: bold; text-align: center; }
    td[contenteditable], th[contenteditable] { background-color: #fffbe6; }
    .score-row td { font-weight: bold; background-color: #e8ffe8; }
    .finance-header { background-color: #d0f0d0; font-weight: bold; text-align: center; }
    .finance-table td { text-align: center; }
    #saveStatus { text-align: center; margin-top: 10px; color: green; }
    button { margin-right: 10px; padding: 8px 16px; }
  </style>
</head>
<body>

<h1>Manufacturer Qualification Checklist</h1>

<div id="instructions">
  <strong>Instructions:</strong><br>
  - Edit vendor names directly in the header row.<br>
  - For each question, enter a score from <strong>1 to 5</strong> under each vendor.<br>
  - Fill in financial inputs per vendor below the checklist.<br>
  - All data is saved locally and reloads when you reopen the file.<br>
  - Use the buttons at the bottom to print or export your financial summary.
</div>

<div id="saveStatus"></div>

<!-- Checklist Table -->
<table id="checklistTable">
  <thead>
    <tr>
      <th>Question</th>
      <th>Expected Answer</th>
      <th contenteditable id="vendor1">Vendor 1</th>
      <th contenteditable id="vendor2">Vendor 2</th>
      <th contenteditable id="vendor3">Vendor 3</th>
      <th contenteditable id="vendor4">Vendor 4</th>
      <th contenteditable id="vendor5">Vendor 5</th>
    </tr>
  </thead>
  <tbody>
    <tr><td class="category" colspan="7">Design & Development</td></tr>
    <tr><td>Process from design to sample?</td><td>Clear steps with feedback loop</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Pattern grading and tech pack support?</td><td>Yes, multi-size experience</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Design confidentiality/IP protection?</td><td>NDA or contract clause</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>

    <tr><td class="category" colspan="7">Materials & Accessories</td></tr>
    <tr><td>Fabric and trim sourcing?</td><td>Named suppliers or markets</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Material approval before bulk?</td><td>Yes, swatches or samples</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>

    <tr><td class="category" colspan="7">Production & Capacity</td></tr>
    <tr><td>Monthly production capacity?</td><td>Specific numbers with examples</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>MOQ policy?</td><td>Clear terms or flexible</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Factory visit possible?</td><td>Yes, scheduled tour</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>

    <tr><td class="category" colspan="7">Quality Control</td></tr>
    <tr><td>QC steps during/after production?</td><td>In-line checks and final inspection</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>QC reports or defect logs?</td><td>Yes, with documentation</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Defect handling policy?</td><td>Rework or refund policy</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>

    <tr><td class="category" colspan="7">Delivery & Logistics</td></tr>
    <tr><td>Lead times for sample and bulk?</td><td>Specific timelines with buffer</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Shipping and customs handling?</td><td>Clear roles and options</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Tracking and delivery confirmation?</td><td>Yes, with courier details</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>

    <tr><td class="category" colspan="7">Business Terms</td></tr>
    <tr><td>Payment terms?</td><td>30‚Äì50% deposit, balance on delivery</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Milestone-based payments?</td><td>Yes, with flexibility</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>References or past clients?</td><td>Yes, with contact info</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>
    <tr><td>Legal registration?</td><td>Yes, with license number</td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td><td contenteditable></td></tr>

    <tr class="score-row">
      <td colspan="2">Total Score</td>
      <td id="score1">0</td>
      <td id="score2">0</td>
      <td id="score3">0</td>
      <td id="score4">0</td>
      <td id="score5">0</td>
    </tr>
  </tbody>
</table>
<h2>Financial Summary (Per Vendor)</h2>
<table id="financeTable" class="finance-table">
  <tr>
    <th class="finance-header">Metric</th>
    <th contenteditable id="f_vendor1">Vendor 1</th>
    <th contenteditable id="f_vendor2">Vendor 2</th>
    <th contenteditable id="f_vendor3">Vendor 3</th>
    <th contenteditable id="f_vendor4">Vendor 4</th>
    <th contenteditable id="f_vendor5">Vendor 5</th>
  </tr>
  <tr><td>Cost per Piece</td><td contenteditable id="cost1"></td><td contenteditable id="cost2"></td><td contenteditable id="cost3"></td><td contenteditable id="cost4"></td><td contenteditable id="cost5"></td></tr>
  <tr><td>Number of Pieces</td><td contenteditable id="qty1"></td><td contenteditable id="qty2"></td><td contenteditable id="qty3"></td><td contenteditable id="qty4"></td><td contenteditable id="qty5"></td></tr>
  <tr><td>Total Manufacturing Cost</td><td id="total1"></td><td id="total2"></td><td id="total3"></td><td id="total4"></td><td id="total5"></td></tr>
  <tr><td>Shipping %</td><td contenteditable id="shipPct1"></td><td contenteditable id="shipPct2"></td><td contenteditable id="shipPct3"></td><td contenteditable id="shipPct4"></td><td contenteditable id="shipPct5"></td></tr>
  <tr><td>Shipping Cost</td><td id="shipCost1"></td><td id="shipCost2"></td><td id="shipCost3"></td><td id="shipCost4"></td><td id="shipCost5"></td></tr>
  <tr><td>Marketing %</td><td contenteditable id="mktPct1"></td><td contenteditable id="mktPct2"></td><td contenteditable id="mktPct3"></td><td contenteditable id="mktPct4"></td><td contenteditable id="mktPct5"></td></tr>
  <tr><td>Marketing Cost</td><td id="mktCost1"></td><td id="mktCost2"></td><td id="mktCost3"></td><td id="mktCost4"></td><td id="mktCost5"></td></tr>
  <tr><td>Admin %</td><td contenteditable id="adminPct1"></td><td contenteditable id="adminPct2"></td><td contenteditable id="adminPct3"></td><td contenteditable id="adminPct4"></td><td contenteditable id="adminPct5"></td></tr>
  <tr><td>Admin Cost</td><td id="adminCost1"></td><td id="adminCost2"></td><td id="adminCost3"></td><td id="adminCost4"></td><td id="adminCost5"></td></tr>
  <tr><td>Delivery %</td><td contenteditable id="delivPct1"></td><td contenteditable id="delivPct2"></td><td contenteditable id="delivPct3"></td><td contenteditable id="delivPct4"></td><td contenteditable id="delivPct5"></td></tr>
  <tr><td>Delivery Cost</td><td id="delivCost1"></td><td id="delivCost2"></td><td id="delivCost3"></td><td id="delivCost4"></td><td id="delivCost5"></td></tr>
  <td>All-In Total Cost</td>
  <td id="allCost1"></td>
  <td id="allCost2"></td>
  <td id="allCost3"></td>
  <td id="allCost4"></td>
  <td id="allCost5"></td>
</tr>
<tr>
  <td>Enter Margin %</td>
  <td contenteditable id="marginPct1">50</td>
  <td contenteditable id="marginPct2">50</td>
  <td contenteditable id="marginPct3">50</td>
  <td contenteditable id="marginPct4">50</td>
  <td contenteditable id="marginPct5">50</td>
</tr>
  <tr><td>Margin (50%)</td><td id="margin1"></td><td id="margin2"></td><td id="margin3"></td><td id="margin4"></td><td id="margin5"></td></tr>
  <tr><td>Sell Price per Piece</td><td id="sellPrice1"></td><td id="sellPrice2"></td><td id="sellPrice3"></td><td id="sellPrice4"></td><td id="sellPrice5"></td></tr>
  <tr><td>Total Revenue</td><td id="revenue1"></td><td id="revenue2"></td><td id="revenue3"></td><td id="revenue4"></td><td id="revenue5"></td></tr>
  <tr><td>Gross Profit (GP)</td><td id="gp1"></td><td id="gp2"></td><td id="gp3"></td><td id="gp4"></td><td id="gp5"></td></tr>
  <tr><td>Operating Profit (OP)</td><td id="op1"></td><td id="op2"></td><td id="op3"></td><td id="op4"></td><td id="op5"></td></tr>
  <tr><td>Gross Profit %</td><td id="gpPct1"></td><td id="gpPct2"></td><td id="gpPct3"></td><td id="gpPct4"></td><td id="gpPct5"></td></tr>
  <tr><td>Operating Profit %</td><td id="opPct1"></td><td id="opPct2"></td><td id="opPct3"></td><td id="opPct4"></td><td id="opPct5"></td></tr>
</table>

<div style="text-align:center; margin-bottom:40px;">
  <button onclick="window.print()">üñ®Ô∏è Print Summary</button>
  <button onclick="exportFinanceCSV()">üìÅ Export to CSV</button>
</div>
<script>
const checklistTable = document.getElementById("checklistTable");
const financeTable = document.getElementById("financeTable");
const saveStatus = document.getElementById("saveStatus");

// Checklist scoring
function updateScores() {
  const rows = checklistTable.querySelectorAll("tbody tr");
  const totals = [0, 0, 0, 0, 0];
  rows.forEach(row => {
    const cells = row.querySelectorAll("td");
    if (cells.length === 7 && !row.classList.contains("score-row")) {
      for (let i = 2; i <= 6; i++) {
        const val = parseFloat(cells[i].textContent.trim());
        if (!isNaN(val)) totals[i - 2] += val;
      }
    }
  });
  for (let i = 0; i < 5; i++) {
    const scoreCell = document.getElementById(`score${i + 1}`);
    if (scoreCell) scoreCell.textContent = totals[i];
  }
}

// Financial calculations per vendor
function calculateFinance() {
  for (let i = 1; i <= 5; i++) {
    const cost = parseFloat(document.getElementById(`cost${i}`)?.textContent.trim()) || 0;
    const qty = parseFloat(document.getElementById(`qty${i}`)?.textContent.trim()) || 0;
    const total = cost * qty;

    const shipPct = parseFloat(document.getElementById(`shipPct${i}`)?.textContent.trim()) || 0;
    const mktPct = parseFloat(document.getElementById(`mktPct${i}`)?.textContent.trim()) || 0;
    const adminPct = parseFloat(document.getElementById(`adminPct${i}`)?.textContent.trim()) || 0;
    const delivPct = parseFloat(document.getElementById(`delivPct${i}`)?.textContent.trim()) || 0;

    const shipCost = shipPct / 100 * total;
    const mktCost = mktPct / 100 * total;
    const adminCost = adminPct / 100 * total;
    const delivCost = delivPct / 100 * total;
    const allCost = total + shipCost + mktCost + adminCost + delivCost;
    
    const marginPct = parseFloat(document.getElementById(`marginPct${i}`)?.textContent.trim()) || 50;
    const margin = allCost * (1 + marginPct / 100);

    // const margin = allCost * 1.5;
    const sellPrice = qty ? margin / qty : 0;
    const revenue = sellPrice * qty;
    const gp = revenue - total;
    const op = gp - (shipCost + mktCost + adminCost + delivCost);
    const gpPct = revenue ? (gp / revenue * 100) : 0;
    const opPct = revenue ? (op / revenue * 100) : 0;

    document.getElementById(`total${i}`).textContent = total.toFixed(2);
    document.getElementById(`shipCost${i}`).textContent = shipCost.toFixed(2);
    document.getElementById(`mktCost${i}`).textContent = mktCost.toFixed(2);
    document.getElementById(`adminCost${i}`).textContent = adminCost.toFixed(2);
    document.getElementById(`delivCost${i}`).textContent = delivCost.toFixed(2);
    document.getElementById(`allCost${i}`).textContent = allCost.toFixed(2);
    document.getElementById(`margin${i}`).textContent = margin.toFixed(2);
    document.getElementById(`sellPrice${i}`).textContent = sellPrice.toFixed(2);
    document.getElementById(`revenue${i}`).textContent = revenue.toFixed(2);
    document.getElementById(`gp${i}`).textContent = gp.toFixed(2);
    document.getElementById(`op${i}`).textContent = op.toFixed(2);
    document.getElementById(`gpPct${i}`).textContent = gpPct.toFixed(2) + "%";
    document.getElementById(`opPct${i}`).textContent = opPct.toFixed(2) + "%";
  }
}

// Save checklist
function saveChecklist() {
  localStorage.setItem("manufacturerChecklist", checklistTable.innerHTML);
  saveStatus.textContent = "üíæ Checklist saved";
  setTimeout(() => saveStatus.textContent = "", 2000);
}

// Load checklist
function loadChecklist() {
  const saved = localStorage.getItem("manufacturerChecklist");
  if (saved) {
    checklistTable.innerHTML = saved;
  }
  updateScores();
}

// Save finance inputs
function saveFinance() {
  const ids = ["cost", "qty", "shipPct", "mktPct", "adminPct", "delivPct"];
  for (let i = 1; i <= 5; i++) {
    ids.forEach(prefix => {
      const cell = document.getElementById(`${prefix}${i}`);
      if (cell) localStorage.setItem(`${prefix}${i}`, cell.textContent);
    });
  }
  calculateFinance();
  saveStatus.textContent = "üíæ Finance saved";
  setTimeout(() => saveStatus.textContent = "", 2000);
}

// Load finance inputs
function loadFinance() {
  const ids = ["cost", "qty", "shipPct", "mktPct", "adminPct", "delivPct"];
  for (let i = 1; i <= 5; i++) {
    ids.forEach(prefix => {
      const val = localStorage.getItem(`${prefix}${i}`);
      if (val !== null) {
        const cell = document.getElementById(`${prefix}${i}`);
        if (cell) cell.textContent = val;
      }
    });
  }
  calculateFinance();
}

// Export finance table to CSV
function exportFinanceCSV() {
  const rows = financeTable.querySelectorAll("tr");
  let csv = [];
  rows.forEach(row => {
    const cols = row.querySelectorAll("td, th");
    let rowData = [];
    cols.forEach(col => {
      rowData.push('"' + col.textContent.trim().replace(/"/g, '""') + '"');
    });
    csv.push(rowData.join(","));
  });

  const csvContent = "data:text/csv;charset=utf-8," + csv.join("\n");
  const encodedUri = encodeURI(csvContent);
  const link = document.createElement("a");
  link.setAttribute("href", encodedUri);
  link.setAttribute("download", "financial_summary.csv");
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Unified load
window.onload = () => {
  loadChecklist();
  loadFinance();
};

// Unified save
checklistTable.addEventListener("input", () => {
  saveChecklist();
});

financeTable.addEventListener("input", () => {
  saveFinance();
});
</script>
</body>
</html>